<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
       th:replace="~{layouts/default_layout :: layout(pageTitle='L·ªãch s·ª≠ ƒë∆°n h√†ng', content=~{::content}, additionalJs=~{::additionalJs})}">
<head>


</head>
<body>
<th:block th:fragment="content">
    <div class="container my-5">
        <h3 class="fw-bold mb-4"><i class="fas fa-box me-2"></i>L·ªãch s·ª≠ ƒë∆°n h√†ng</h3>

        <!-- üß≠ B·ªô l·ªçc tr·∫°ng th√°i -->
        <div class="mb-4 text-center">
            <div class="btn-group flex-wrap" role="group">
                <button type="button" class="btn btn-outline-primary active" data-status="">T·∫•t c·∫£</button>
                <button type="button" class="btn btn-outline-warning" data-status="PENDING">Ch·ªù x√°c nh·∫≠n</button>
                <button type="button" class="btn btn-outline-secondary" data-status="CONFIRMED">ƒê√£ x√°c nh·∫≠n</button>
                <button type="button" class="btn btn-outline-info" data-status="WAITING_FOR_PICKUP">Ch·ªù l·∫•y h√†ng</button>
                <button type="button" class="btn btn-outline-primary" data-status="SHIPPING">ƒêang giao</button>
                <button type="button" class="btn btn-outline-success" data-status="COMPLETED">Ho√†n th√†nh</button>
                <button type="button" class="btn btn-outline-danger" data-status="CANCELED">ƒê√£ h·ªßy</button>
            </div>
        </div>

        <!-- üßæ Danh s√°ch ƒë∆°n h√†ng -->
        <div id="ordersList" class="d-flex flex-column gap-3">
            <div class="text-center text-muted py-5">ƒêang t·∫£i d·ªØ li·ªáu...</div>
        </div>
    </div>

    <!-- üì¶ Modal Chi ti·∫øt ƒë∆°n h√†ng -->
    <div class="modal fade" id="orderDetailModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">
                        <i class="fas fa-box-open me-2"></i>Chi ti·∫øt ƒë∆°n h√†ng <span id="modalOrderCode"></span>
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
                </div>
                <div class="modal-body">
                    <div id="orderModalLoading" class="text-center py-3 text-muted">ƒêang t·∫£i d·ªØ li·ªáu...</div>
                    <div id="orderModalContent" style="display:none;">

                        <!-- üõçÔ∏è S·∫£n ph·∫©m -->
                        <div class="mb-4">
                            <h6 class="fw-bold mb-2">S·∫£n ph·∫©m</h6>
                            <table class="table table-sm align-middle mb-0">
                                <thead>
                                <tr>
                                    <th>T√™n SP</th>
                                    <th>Size</th>
                                    <th>SL</th>
                                    <th>Gi√°</th>
                                    <th>Th√†nh ti·ªÅn</th>
                                </tr>
                                </thead>
                                <tbody id="modalOrderItems"></tbody>
                            </table>
                        </div>

                        <!-- üìÖ Th√¥ng tin ƒë∆°n -->
                        <div class="mb-3">
                            <div class="d-flex justify-content-between mb-2">
                                <div><strong>Ng√†y ƒë·∫∑t:</strong> <span id="modalOrderDate"></span></div>
                                <span class="badge" id="modalOrderStatus"></span>
                            </div>
                            <div class="mb-2"><strong>Ph∆∞∆°ng th·ª©c thanh to√°n:</strong> <span id="modalOrderPayment"></span></div>
                            <div class="mb-2"><strong>Tr·∫°ng th√°i thanh to√°n:</strong> <span id="modalPaymentStatus" class="badge"></span></div>
                            <div class="mt-2">
                                <strong>ƒê·ªãa ch·ªâ giao h√†ng:</strong> <span id="modalOrderAddress"></span>
                            </div>
                        </div>

                        <!-- üí∞ T·ªïng h·ª£p chi ph√≠ -->
                        <div class="mb-3">
                            <table class="table table-sm w-auto mb-0">
                                <tbody>
                                <tr>
                                    <td class="text-muted">T·∫°m t√≠nh</td>
                                    <td class="text-end"><span id="modalSubtotal">0 ‚Ç´</span></td>
                                </tr>
                                <tr>
                                    <td class="text-muted">Gi·∫£m gi√°</td>
                                    <td class="text-end text-danger">- <span id="modalDiscount">0 ‚Ç´</span></td>
                                </tr>
                                <tr>
                                    <td class="text-muted">Ph√≠ v·∫≠n chuy·ªÉn</td>
                                    <td class="text-end"><span id="modalShipping">0 ‚Ç´</span></td>
                                </tr>
                                <tr class="table-light">
                                    <td class="fw-bold">T·ªïng c·ªông</td>
                                    <td class="text-end fw-bold text-success"><span id="modalOrderTotal">0 ‚Ç´</span></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- üïí L·ªãch s·ª≠ tr·∫°ng th√°i -->
                        <div>
                            <h6 class="fw-bold">L·ªãch s·ª≠ tr·∫°ng th√°i</h6>
                            <ul class="timeline list-unstyled" id="modalOrderHistory"></ul>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                    <button id="btnCancelOrder" class="btn btn-danger d-none">
                        <i class="fas fa-times me-1"></i> H·ªßy ƒë∆°n h√†ng
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- üìù Modal ƒê√°nh gi√° s·∫£n ph·∫©m -->
    <div class="modal fade" id="reviewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">
                        <i class="fas fa-star text-warning me-2"></i>ƒê√°nh gi√° s·∫£n ph·∫©m
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
                </div>
                <div class="modal-body">
                    <!-- üè∑ T√™n s·∫£n ph·∫©m -->
                    <div class="mb-3">
                        <label class="form-label fw-bold">S·∫£n ph·∫©m</label>
                        <div id="reviewProductName" class="form-control-plaintext"></div>
                    </div>

                    <!-- ‚≠ê Ch·ªçn sao -->
                    <div class="mb-3">
                        <label class="form-label fw-bold">ƒê√°nh gi√°</label>
                        <div id="reviewStars" class="fs-4 text-warning">
                            <i class="far fa-star" data-value="1"></i>
                            <i class="far fa-star" data-value="2"></i>
                            <i class="far fa-star" data-value="3"></i>
                            <i class="far fa-star" data-value="4"></i>
                            <i class="far fa-star" data-value="5"></i>
                        </div>
                    </div>

                    <!-- ‚úçÔ∏è N·ªôi dung -->
                    <div class="mb-3">
                        <label for="reviewContent" class="form-label fw-bold">N·ªôi dung (‚â• 50 k√Ω t·ª±)</label>
                        <textarea id="reviewContent" class="form-control" rows="4"></textarea>
                    </div>

                    <!-- üì∏ ·∫¢nh / video -->
                    <div class="mb-3">
                        <label for="reviewMedia" class="form-label fw-bold">·∫¢nh / video (t√πy ch·ªçn)</label>
                        <input type="file" id="reviewMedia" class="form-control" accept="image/*,video/*" multiple>
                        <div class="small text-muted mt-1">B·∫°n c√≥ th·ªÉ ch·ªçn nhi·ªÅu t·ªáp (jpg, png, mp4,...)</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                    <button id="btnEditReview" class="btn btn-outline-primary d-none">
                        <i class="fas fa-pen"></i> S·ª≠a ƒë√°nh gi√°
                    </button>
                    <button id="btnSubmitReview" class="btn btn-primary">
                        <i class="fas fa-paper-plane me-1"></i> G·ª≠i ƒë√°nh gi√°
                    </button>
                </div>
            </div>
        </div>
    </div>
</th:block>

<th:block th:fragment="additionalJs">
    <script type="module" th:src="@{/js/order-history.js}"></script>
</th:block>
</body>
</html>
