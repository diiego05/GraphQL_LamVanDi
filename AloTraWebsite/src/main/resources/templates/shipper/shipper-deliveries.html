<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layouts/shipper_layout :: layout(${pageTitle}, ~{::pageContent}, ~{::additionalJs})}">
<head></head>
<body>

<!-- üì¶ N·ªôi dung ch√≠nh -->
<div class="page-content" th:fragment="pageContent">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="mb-0">üöö Danh s√°ch ƒë∆°n giao</h4>
    <div class="d-flex gap-2">
      <input id="shipperSearch" class="form-control form-control-sm" placeholder="üîé T√¨m theo m√£ ƒë∆°n...">
      <button id="shipperReload" class="btn btn-outline-secondary btn-sm"><i class="fas fa-rotate"></i></button>
    </div>
  </div>

  <div class="row g-3">
    <!-- B·∫£ng danh s√°ch -->
    <div class="col-lg-6">
      <div class="card shadow-sm">
        <div class="card-header bg-light fw-bold">ƒê∆°n ƒë∆∞·ª£c giao</div>
        <div class="card-body p-0">
          <div class="table-responsive">
            <table class="table table-hover align-middle mb-0" id="shipperTable">
              <thead class="table-light">
                <tr>
                  <th>M√£ ƒë∆°n</th>
                  <th>ƒê·ªãa ch·ªâ</th>
                  <th>Tr·∫°ng th√°i</th>
                  <th>Ng√†y t·∫°o</th>
                  <th class="text-center">Xem</th>
                </tr>
              </thead>
              <tbody id="deliveryTableBody">
                <tr>
                  <td colspan="5" class="text-center text-muted py-4">ƒêang t·∫£i...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="card-footer small text-muted">
          Nh·∫•n v√†o bi·ªÉu t∆∞·ª£ng üëÅ ƒë·ªÉ xem chi ti·∫øt
        </div>
      </div>
    </div>

    <!-- Panel chi ti·∫øt -->
    <div class="col-lg-6">
      <div class="card shadow-sm" id="detailCard" style="display:none;">
        <div class="card-header d-flex justify-content-between align-items-center">
          <div class="fw-bold">
            <i class="fas fa-box-open me-2"></i>ƒê∆°n <span id="detailCode"></span>
          </div>
          <span id="detailStatus" class="badge"></span>
        </div>

        <div class="card-body" id="detailLoading">
          <div class="text-center text-muted py-3">
            <div class="spinner-border spinner-border-sm me-2"></div>ƒêang t·∫£i chi ti·∫øt...
          </div>
        </div>

        <div class="card-body" id="detailContent" style="display:none;">
          <div class="row mb-2">
            <div class="col-md-6">
              <div><strong>Ng√†y ƒë·∫∑t:</strong> <span id="detailDate"></span></div>
              <div><strong>Ph∆∞∆°ng th·ª©c:</strong> <span id="detailPayment"></span></div>
            </div>
            <div class="col-md-6">
              <div><strong>ƒê·ªãa ch·ªâ:</strong> <span id="detailAddress"></span></div>
            </div>
          </div>

          <!-- S·∫£n ph·∫©m -->
          <h6 class="fw-bold mt-2">S·∫£n ph·∫©m</h6>
          <div class="table-responsive">
            <table class="table table-sm align-middle mb-0">
              <thead>
              <tr>
                <th>T√™n SP</th>
                <th>Size</th>
                <th>SL</th>
                <th>Gi√°</th>
                <th>Th√†nh ti·ªÅn</th>
              </tr>
              </thead>
              <tbody id="detailItems"></tbody>
            </table>
          </div>

          <!-- T·ªïng h·ª£p -->
          <div class="table-responsive mt-3">
            <table class="table table-sm mb-0">
              <tbody>
              <tr><td>T·∫°m t√≠nh</td><td class="text-end"><span id="detailSubtotal"></span></td></tr>
              <tr><td>Gi·∫£m gi√°</td><td class="text-end text-danger">- <span id="detailDiscount"></span></td></tr>
              <tr><td>Ph√≠ v·∫≠n chuy·ªÉn</td><td class="text-end"><span id="detailShipping"></span></td></tr>
              <tr class="table-light fw-bold"><td>T·ªïng c·ªông</td><td class="text-end text-success"><span id="detailTotal"></span></td></tr>
              </tbody>
            </table>
          </div>

          <!-- Timeline -->
          <h6 class="fw-bold mt-4 mb-2">L·ªãch s·ª≠ tr·∫°ng th√°i</h6>
          <ul class="timeline list-unstyled" id="detailHistory"></ul>
        </div>

        <div class="card-footer d-flex justify-content-between">
          <div class="d-flex gap-2">
            <button id="btnAccept" class="btn btn-primary d-none">
              <i class="fas fa-hand-paper me-1"></i> Nh·∫≠n ƒë∆°n
            </button>
            <button id="btnDelivered" class="btn btn-success d-none">
              <i class="fas fa-check me-1"></i> Giao th√†nh c√¥ng
            </button>
          </div>
          <button id="btnCloseDetail" class="btn btn-outline-secondary">ƒê√≥ng</button>
        </div>
      </div>

      <!-- Khung r·ªóng khi ch∆∞a ch·ªçn ƒë∆°n -->
      <div class="card border-0 bg-light" id="emptyDetailCard">
        <div class="card-body text-center text-muted">
          <i class="fas fa-info-circle me-1"></i> H√£y ch·ªçn m·ªôt ƒë∆°n ·ªü b·∫£ng b√™n tr√°i ƒë·ªÉ xem chi ti·∫øt
        </div>
      </div>
    </div>
  </div>
</div>

<th:block th:fragment="additionalJs">
  <script type="module" src="/alotra-website/js/shipper-deliveries.js"></script>
  <style>
    .timeline-dot{width:12px;height:12px;border-radius:50%;flex-shrink:0}
    .order-row:hover{background:#f8f9fa}
  </style>
</th:block>

</body>
</html>
