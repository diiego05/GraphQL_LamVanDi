<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layouts/admin-layout :: layout(pageTitle='Qu·∫£n l√Ω ƒë∆°n h√†ng', pageContent=~{::content}, additionalJs=~{::additionalJs})}">
<head>
    <meta charset="UTF-8">
    <title>Qu·∫£n l√Ω ƒë∆°n h√†ng</title>
</head>
<body>
<th:block th:fragment="content">
    <div class="container-fluid">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 class="fw-bold mb-0"><i class="fas fa-box me-2"></i>Qu·∫£n l√Ω ƒë∆°n h√†ng</h3>

            <div class="d-flex gap-2">
                <!-- B·ªô l·ªçc chi nh√°nh -->
                <select id="adminBranchFilter" class="form-select form-select-sm">
                    <option value="">T·∫•t c·∫£ chi nh√°nh</option>
                </select>

                <!-- T√¨m ki·∫øm -->
                <input type="text" id="adminOrderSearch" class="form-control form-control-sm" placeholder="üîç T√¨m theo m√£ ƒë∆°n...">

                <button class="btn btn-outline-secondary btn-sm" id="adminOrderReload">
                    <i class="fas fa-rotate"></i>
                </button>
            </div>
        </div>

        <!-- üß≠ B·ªô l·ªçc tr·∫°ng th√°i -->
        <div class="mb-4 text-center">
            <div class="btn-group flex-wrap" role="group" id="adminStatusFilter">
                <button type="button" class="btn btn-outline-primary active" data-status="">T·∫•t c·∫£</button>
                <button type="button" class="btn btn-outline-warning" data-status="PENDING">Ch·ªù x√°c nh·∫≠n</button>
                <button type="button" class="btn btn-outline-secondary" data-status="CONFIRMED">ƒê√£ x√°c nh·∫≠n</button>
                <button type="button" class="btn btn-outline-info" data-status="SHIPPING">ƒêang giao</button>
                <button type="button" class="btn btn-outline-success" data-status="COMPLETED">Ho√†n th√†nh</button>
                <button type="button" class="btn btn-outline-danger" data-status="CANCELED">ƒê√£ h·ªßy</button>
            </div>
        </div>

        <!-- üì¶ Danh s√°ch -->
        <div class="table-responsive shadow-sm rounded">
            <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th>M√£ ƒë∆°n</th>
                        <th>Ng√†y ƒë·∫∑t</th>
                        <th>Chi nh√°nh</th>

                        <th>T·ªïng ti·ªÅn</th>
                        <th>Thanh to√°n</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th class="text-center">H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody id="adminOrdersList">
                    <tr>
                        <td colspan="8" class="text-center text-muted py-4">ƒêang t·∫£i d·ªØ li·ªáu...</td>
                    </tr>
                </tbody>
            </table>
        </div>
         <!-- üìÑ Thanh ph√¢n trang -->
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center mt-3" id="orderPagination"></ul>
        </nav>
    </div>

    <!-- üìú Modal chi ti·∫øt -->
    <div class="modal fade" id="adminOrderModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title fw-bold">
                        <i class="fas fa-receipt me-2"></i>ƒê∆°n h√†ng <span id="adminModalOrderCode"></span>
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="adminModalLoading" class="text-center py-3 text-muted">ƒêang t·∫£i...</div>
                    <div id="adminModalContent" style="display:none;">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <p><strong>Ng√†y ƒë·∫∑t:</strong> <span id="adminModalOrderDate"></span></p>
                                <p><strong>Ph∆∞∆°ng th·ª©c:</strong> <span id="adminModalPayment"></span></p>
                            </div>
                            <div class="col-md-6 text-md-end">
                                <p><strong>Tr·∫°ng th√°i:</strong> <span class="badge fs-6" id="adminModalOrderStatus"></span></p>
                                <p><strong>Chi nh√°nh:</strong> <span id="adminModalBranchName"></span></p>
                                <p><strong>ƒê·ªãa ch·ªâ:</strong> <span id="adminModalAddress"></span></p>
                            </div>
                        </div>

                        <!-- üõçÔ∏è Danh s√°ch s·∫£n ph·∫©m -->
                        <h6 class="fw-bold mb-2">Danh s√°ch s·∫£n ph·∫©m</h6>
                        <div class="table-responsive mb-3">
                            <table class="table table-sm align-middle mb-0">
                                <thead>
                                    <tr>
                                        <th>T√™n SP</th>
                                        <th>Size</th>
                                        <th>SL</th>
                                        <th>Gi√°</th>
                                        <th>Th√†nh ti·ªÅn</th>
                                    </tr>
                                </thead>
                                <tbody id="adminModalOrderItems"></tbody>
                            </table>
                        </div>

                        <!-- üí∞ T·ªïng h·ª£p -->
                        <div class="table-responsive mb-3">
                            <table class="table table-sm mb-0">
                                <tbody>
                                    <tr><td>T·∫°m t√≠nh</td><td class="text-end"><span id="adminModalSubtotal"></span></td></tr>
                                    <tr><td>Gi·∫£m gi√°</td><td class="text-end text-danger">- <span id="adminModalDiscount"></span></td></tr>
                                    <tr><td>Ph√≠ v·∫≠n chuy·ªÉn</td><td class="text-end"><span id="adminModalShipping"></span></td></tr>
                                    <tr class="table-light fw-bold"><td>T·ªïng c·ªông</td><td class="text-end text-success"><span id="adminModalTotal"></span></td></tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- üïì Timeline -->
                        <h6 class="fw-bold mt-4 mb-2">L·ªãch s·ª≠ tr·∫°ng th√°i</h6>
                        <ul class="timeline list-unstyled" id="adminModalOrderHistory"></ul>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                </div>
            </div>
        </div>
    </div>
</th:block>

<th:block th:fragment="additionalJs">
    <script type="module" src="/alotra-website/js/admin-orders.js"></script>
</th:block>
</body>
</html>
