<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layouts/admin-layout :: layout(pageTitle=${pageTitle}, pageContent=~{::content}, additionalJs=~{::additionalJs})}">

<th:block th:fragment="content">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h3>üéüÔ∏è M√£ gi·∫£m gi√°</h3>
        <button class="btn btn-primary" id="btnAddCoupon">
            <i class="fas fa-plus me-2"></i> Th√™m m·ªõi
        </button>
    </div>

    <!-- ==================== üìã DANH S√ÅCH COUPON ==================== -->
    <div class="card">
        <div class="table-responsive">
            <table class="table table-striped align-middle">
                <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>M√£</th>
                        <th>Chi·∫øn d·ªãch</th>
                        <th>B·∫Øt ƒë·∫ßu</th>
                        <th>K·∫øt th√∫c</th>
                        <th>Lo·∫°i</th>
                        <th>Gi√° tr·ªã</th>
                        <th>L∆∞·ª£t</th>
                        <th>ƒê√£ d√πng</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody id="couponTableBody"></tbody>
            </table>
        </div>
    </div>

    <!-- ==================== ü™Ñ MODAL TH√äM / S·ª¨A ==================== -->
    <div class="modal fade" id="couponModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-md modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="couponModalTitle">Th√™m m√£ gi·∫£m gi√°</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">
                    <form id="couponForm">
                        <input type="hidden" name="id" id="couponId">

                        <!-- üÜî M√£ gi·∫£m gi√° -->
                        <div class="mb-3">
                            <label class="form-label">M√£</label>
                            <input type="text" class="form-control" name="code" id="couponCode" required>
                        </div>

                        <!-- üì¢ Chi·∫øn d·ªãch -->
                        <div class="mb-3">
                            <label class="form-label">Chi·∫øn d·ªãch</label>
                            <select class="form-select" name="campaignId" id="couponCampaign" required>
                                <option value="" disabled selected>‚Äî Vui l√≤ng ch·ªçn chi·∫øn d·ªãch ‚Äî</option>
                            </select>
                            <div class="form-text text-muted">
                                Lo·∫°i v√† gi√° tr·ªã gi·∫£m s·∫Ω t·ª± ƒë·ªông l·∫•y t·ª´ chi·∫øn d·ªãch ƒë√£ ch·ªçn.
                            </div>
                        </div>

                        <!-- üìÖ Th·ªùi gian -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Ng√†y b·∫Øt ƒë·∫ßu</label>
                                <input type="date" class="form-control" id="campaignStartAt" readonly>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Ng√†y k·∫øt th√∫c</label>
                                <input type="date" class="form-control" id="campaignEndAt" readonly>
                            </div>
                        </div>

                        <!-- üßæ Lo·∫°i gi·∫£m gi√° -->
                        <div class="mb-3">
                            <label class="form-label">Lo·∫°i m√£ gi·∫£m gi√°</label>
                            <!-- ‚ö° Hidden g·ª≠i enum g·ªëc -->
                            <input type="hidden" name="type" id="couponTypeHidden">
                            <!-- üëÅÔ∏è Hi·ªÉn th·ªã ti·∫øng Vi·ªát -->
                            <input type="text" class="form-control" id="couponType" readonly>
                        </div>

                        <!-- üí∏ Gi√° tr·ªã -->
                        <div class="mb-3">
                            <label class="form-label">Gi√° tr·ªã gi·∫£m</label>
                            <input type="text" class="form-control" name="value" id="couponValue" readonly>
                        </div>

                        <!-- ü™ô M·ª©c gi·∫£m t·ªëi ƒëa (n·∫øu l√† % ƒë∆°n h√†ng) -->
                        <div class="mb-3" id="maxDiscountGroup" style="display: none;">
                            <label class="form-label">M·ª©c gi·∫£m t·ªëi ƒëa (VND)</label>
                            <input type="number" step="0.01" class="form-control" name="maxDiscount" id="couponMaxDiscount">
                        </div>

                        <!-- üßæ ƒê∆°n h√†ng t·ªëi thi·ªÉu -->
                        <div class="mb-3">
                            <label class="form-label">ƒê∆°n h√†ng t·ªëi thi·ªÉu (VND)</label>
                            <input type="number" step="0.01" class="form-control" name="minOrderTotal" id="couponMinOrderTotal">
                        </div>

                        <!-- üî¢ S·ªë l∆∞·ª£t -->
                        <div class="mb-3">
                            <label class="form-label">S·ªë l∆∞·ª£t s·ª≠ d·ª•ng</label>
                            <input type="number" class="form-control" name="usageLimit" id="couponUsageLimit" min="0">
                        </div>

                        <div class="modal-footer">
                            <button class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                            <button type="submit" class="btn btn-primary" id="btnSaveCoupon">L∆∞u</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</th:block>

<th:block th:fragment="additionalJs">
<script type="module" th:src="@{/js/promotions/admin-coupon.js}"></script>
</th:block>
</html>
