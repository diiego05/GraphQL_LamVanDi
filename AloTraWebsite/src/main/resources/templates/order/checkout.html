<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layouts/default_layout :: body(content=~{::content}, additionalJs=~{::additionalJs})}">
<head>
    <meta charset="UTF-8">
    <title>Thanh To√°n</title>
</head>
<body>
<th:block th:fragment="content">
    <div class="container my-5">
        <div class="row g-4">

            <!-- üß≠ C·ªôt tr√°i -->
            <div class="col-lg-8">
                <!-- 1Ô∏è‚É£ ƒê·ªãa ch·ªâ giao h√†ng -->
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                        <strong><i class="fas fa-map-marker-alt me-2"></i> ƒê·ªãa ch·ªâ giao h√†ng</strong>
                        <button class="btn btn-light btn-sm" id="btn-add-address">
                            <i class="fas fa-plus me-1"></i> Th√™m ƒë·ªãa ch·ªâ
                        </button>
                    </div>
                    <div class="card-body" id="address-list">
                        <div class="text-muted">ƒêang t·∫£i ƒë·ªãa ch·ªâ...</div>
                    </div>
                </div>

                <!-- 2Ô∏è‚É£ Chi nh√°nh x·ª≠ l√Ω -->
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-success text-white">
                        <strong><i class="fas fa-store me-2"></i> Chi nh√°nh x·ª≠ l√Ω ƒë∆°n h√†ng</strong>
                    </div>
                    <div class="card-body">
                        <select id="branch-select" class="form-select">
                            <option value="">-- Ch·ªçn chi nh√°nh --</option>
                        </select>
                        <div id="branch-warning" class="text-danger mt-2" style="display:none;"></div>
                    </div>
                </div>

                <!-- 3Ô∏è‚É£ ƒê∆°n v·ªã v·∫≠n chuy·ªÉn -->
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-success text-white">
                        <strong><i class="fas fa-truck me-2"></i> ƒê∆°n v·ªã v·∫≠n chuy·ªÉn</strong>
                    </div>
                    <div class="card-body">
                        <select id="carrier-select" class="form-select mb-2">
                            <option value="">-- Ch·ªçn ƒë∆°n v·ªã v·∫≠n chuy·ªÉn --</option>
                        </select>
                        <div class="text-muted">
                            Ph√≠ v·∫≠n chuy·ªÉn: <strong id="shipping-fee">0‚Ç´</strong>
                        </div>
                    </div>
                </div>

                <!-- 4Ô∏è‚É£ M√£ gi·∫£m gi√° -->
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-success text-white">
                        <strong><i class="fas fa-ticket-alt me-2"></i> M√£ gi·∫£m gi√°</strong>
                    </div>
                    <div class="card-body">
                        <div class="input-group">
                            <input type="text" class="form-control" id="coupon-code" placeholder="Nh·∫≠p m√£ gi·∫£m gi√°">
                            <button class="btn btn-success" id="apply-coupon-btn">√Åp d·ª•ng</button>
                        </div>
                        <div id="coupon-msg" class="mt-2 text-success small"></div>
                    </div>
                </div>

                <!-- 5Ô∏è‚É£ Ph∆∞∆°ng th·ª©c thanh to√°n -->
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-success text-white">
                        <strong><i class="fas fa-credit-card me-2"></i> Ph∆∞∆°ng th·ª©c thanh to√°n</strong>
                    </div>
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="paymentMethod" value="PICKUP" id="pm-pickup">
                            <label class="form-check-label" for="pm-pickup">
                                Nh·∫≠n t·∫°i qu√°n
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="paymentMethod" value="COD" id="pm-cod" checked>
                            <label class="form-check-label" for="pm-cod">
                                Thanh to√°n khi nh·∫≠n h√†ng
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="paymentMethod" value="BANK" id="pm-bank">
                            <label class="form-check-label" for="pm-bank">
                                Chuy·ªÉn kho·∫£n
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- üßæ C·ªôt ph·∫£i -->
            <div class="col-lg-4">
                <div class="card shadow-sm sticky-top" style="top: 90px;">
                    <div class="card-header bg-success text-white">
                        <strong><i class="fas fa-shopping-cart me-2"></i> T√≥m t·∫Øt ƒë∆°n h√†ng</strong>
                    </div>
                    <div class="card-body">
                        <div id="checkout-item-list" class="mb-3"></div>
                        <hr>
                        <div class="d-flex justify-content-between">
                            <span>T·∫°m t√≠nh</span>
                            <strong id="subtotal">0‚Ç´</strong>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Gi·∫£m gi√°</span>
                            <strong id="discount">0‚Ç´</strong>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Ph√≠ v·∫≠n chuy·ªÉn</span>
                            <strong id="ship-fee-summary">0‚Ç´</strong>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between fs-5 mb-3">
                            <span><strong>T·ªïng c·ªông</strong></span>
                            <strong id="grand-total">0‚Ç´</strong>
                        </div>
                        <button class="btn btn-lg btn-success w-100" id="btn-confirm-order">
                            <i class="fas fa-check me-2"></i> X√°c nh·∫≠n ƒë·∫∑t h√†ng
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- üè° Modal Th√™m ƒê·ªãa Ch·ªâ -->
    <div class="modal fade" id="addAddressModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title"><i class="fas fa-map-marker-alt me-2"></i> Th√™m ƒë·ªãa ch·ªâ m·ªõi</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-2">
                        <label>Ng∆∞·ªùi nh·∫≠n</label>
                        <input type="text" class="form-control" id="new-recipient">
                    </div>
                    <div class="mb-2">
                        <label>S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="text" class="form-control" id="new-phone">
                    </div>
                    <div class="mb-2">
                        <label>ƒê·ªãa ch·ªâ</label>
                        <input type="text" class="form-control" id="new-line1">
                    </div>
                    <div class="mb-2">
                        <label>Ph∆∞·ªùng/X√£</label>
                        <input type="text" class="form-control" id="new-ward">
                    </div>
                    <div class="mb-2">
                        <label>Qu·∫≠n/Huy·ªán</label>
                        <input type="text" class="form-control" id="new-district">
                    </div>
                    <div class="mb-2">
                        <label>T·ªânh/Th√†nh ph·ªë</label>
                        <input type="text" class="form-control" id="new-city">
                    </div>
                    <div class="form-check mt-2">
                        <input class="form-check-input" type="checkbox" id="new-default">
                        <label class="form-check-label" for="new-default">ƒê·∫∑t l√†m ƒë·ªãa ch·ªâ m·∫∑c ƒë·ªãnh</label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                    <button type="button" class="btn btn-success" id="btn-save-address">L∆∞u</button>
                </div>
            </div>
        </div>
    </div>
</th:block>

<th:block th:fragment="additionalJs">
    <script type="module" th:src="@{/js/checkout.js}"></script>
</th:block>
</body>
</html>
